{"version":3,"file":"webpack-chain-module-resolution-host-adapter.js","sourceRoot":"","sources":["../../src/webpack-chain-module-resolution-host-adapter.ts"],"names":[],"mappings":";;;;;;;;;;;;AACA,sDAAqE;AAErE,qEAAkE;AAGlE;IAA6D,2DAA2B;IAGtF,iDAAY,IAA0B,EAAS,cAA8B;QAA7E,YACE,kBAAM,IAAI,CAAC,SAGZ;QAJ8C,oBAAc,GAAd,cAAc,CAAgB;QAE3E,KAAI,CAAC,OAAO,GAAG,IAAI,+CAAqB,CAAC,cAAc,CAAC,QAAQ,CAAC,iBAAiB,EAAE,EAAE,IAAI,CAAC,CAAC;QAC5F,cAAc,CAAC,oBAAoB,GAAG,KAAI,CAAC;;IAC7C,CAAC;IAED,sBAAI,mEAAc;aAAlB;YACE,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB,EAAE,CAAC;QAC1C,CAAC;;;OAAA;IAED,0DAAQ,GAAR,UAAS,IAAY;QACnB,MAAM,CAAM,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,IAAI,EAAE,iBAAM,QAAQ,YAAC,IAAI,CAAC,CAAC,CAAC;IAClF,CAAC;IAED,8DAAY,GAAZ,UAAa,IAAY;QAAzB,iBAaC;QAXC,IAAM,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;QAElE,EAAE,CAAC,CAAC,OAAO,KAAK,EAAE,CAAC,CAAC,CAAC;YACnB,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAClC,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YACrC,MAAM,IAAI,KAAK,CAAC,kDAAgD,OAAS,CAAC,CAAC;QAC7E,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC;iBAC7B,IAAI,CAAE,UAAA,MAAM,IAAI,OAAA,OAAO,CAAC,OAAO,CAAC,KAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,EAAzE,CAAyE,CAAE,CAAC;QACjG,CAAC;IAEH,CAAC;IACH,8CAAC;AAAD,CAAC,AA/BD,CAA6D,0CAA2B,GA+BvF;AA/BY,0FAAuC","sourcesContent":["import { ModuleResolutionHost } from 'typescript';\nimport { ModuleResolutionHostAdapter } from '@angular/compiler-cli' ;\n\nimport { WebpackResourceLoader } from './webpack-resource-loader';\nimport { WebpackWrapper, ExternalAssetsSource } from './webpack-wrapper';\n\nexport class WebpackChainModuleResolutionHostAdapter extends ModuleResolutionHostAdapter implements ExternalAssetsSource {\n  private _loader: WebpackResourceLoader;\n\n  constructor(host: ModuleResolutionHost, public webpackWrapper: WebpackWrapper) {\n    super(host);\n    this._loader = new WebpackResourceLoader(webpackWrapper.compiler.createCompilation(), true);\n    webpackWrapper.externalAssetsSource = this;\n  }\n\n  get externalAssets(): any {\n    return this._loader.getExternalAssets();\n  }\n\n  readFile(path: string): string {\n    return <any>this.webpackWrapper.readFileTransformer(path, super.readFile(path));\n  }\n\n  readResource(path: string): Promise<string> {\n\n    const newPath = this.webpackWrapper.resourcePathTransformer(path);\n\n    if (newPath === '') {\n      return Promise.resolve(newPath);\n    } else if (!this.fileExists(newPath)) {\n      throw new Error(`Compilation failed. Resource file not found: ${newPath}`);\n    } else {\n      return this._loader.get(newPath)\n        .then( source => Promise.resolve(this.webpackWrapper.resourceTransformer(newPath, source)) );\n    }\n\n  }\n}\n"]}